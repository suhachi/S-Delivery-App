# 🕵️ 업무 R&R 심층 가이드 (Deep Rolebook)

이 문서는 단순한 역할 분담을 넘어, 각 주체가 수행해야 할 업무의 **구체적인 행동 양식, 판단 기준, 완료 조건**을 상세하게 기술합니다.
런칭 프로젝트 참여자는 본인의 역할을 숙지하고 이 기준에 맞춰 행동해야 합니다.

---

## 🏗️ 1. 클라이언트 (Client / 점주)
**핵심 미션**: "내 가게를 디지털로 옮길 **재료(Data & Asset)**를 준비한다."

### 1-1. 브랜드 자산 제공
- **행동**: 앱에 입힐 옷(디자인)과 간판(이름)을 제공합니다.
- **디테일**:
  - **상호명**: 앱 아이콘 아래에 들어갈 짧은 이름(8자 이내 권장)과, 상단바에 노출될 전체 이름을 구분해서 줍니다.
  - **로고**:
    - 배경이 투명한 PNG 파일을 권장합니다.
    - 최소 512x512 픽셀 이상이어야 앱 아이콘으로 썼을 때 깨지지 않습니다.
    - *없으면 텍스트 로고로 대체 가능함을 인지해야 합니다.*

### 1-2. 운영 데이터 준비 (가장 중요)
- **행동**: 손님이 보고 주문할 "메뉴판"을 엑셀이나 메모장에 정리합니다.
- **디테일**:
  - **카테고리 분류**: (예: 메인메뉴 / 사이드 / 음료)
  - **메뉴 정보**: 메뉴명, 가격(원 단위), 상세설명(맛, 양, 맵기 등).
  - **옵션 구성**: (예: 곱배기 +1000원, 고수 빼기 등) 필수/선택 여부를 명확히 결정해야 합니다.
  - **사진**: 메뉴당 1장의 음식 사진 (1:1 정사각형 비율 권장).

### 1-3. 법적/행정적 계약
- **행동**: 돈을 받기 위한 서류 작업을 처리합니다.
- **디테일**:
  - **NICEPAY 계약**: 전자결제대행사(PG)와 계약을 맺고 '상점ID(MID)'와 'Key'를 발급받아야 합니다.
  - **사업자등록증**: PG 계약의 필수 조건입니다.

---

## 🛠️ 2. 개발자 (Developer / KS Operator)
**핵심 미션**: "템플릿이라는 **공장(Factory)**을 돌려 완제품을 찍어내고 배달한다."

### 2-1. 인프라 프로비저닝 (Infrastructure Provisioning)
- **행동**: 앱이 돌아갈 땅(서버/DB)을 닦습니다.
- **디테일**:
  - **Firebase Project 생성**:
    - Google Cloud Console이 아닌 Firebase Console에서 생성해야 설정이 간편합니다.
    - 프로젝트 ID는 되도록 `[상호명]-app` 형식을 지켜 식별하기 쉽게 합니다.
  - **요금제 업그레이드 (Blaze)**:
    - Node.js 기반의 Cloud Functions를 배포하려면 필수입니다. (무료 Spark 요금제 불가)
    - 점주 카드가 아닌 회사(KS) 법인 카드를 등록하고, 추후 청구하는 방식을 고려합니다.

### 2-2. 코드 복제 및 환경 설정 (Cloning & Config)
- **행동**: 템플릿 코드를 가져와서 해당 상점용 설정(Config)만 갈아 끼웁니다.
- **디테일**:
  - **Git Checkout**: `main` 브랜치가 아닌 `tags/v1.0.0`에서 브랜치를 따야 합니다. (검증된 버전 사용)
  - **.env 핸들링**:
    - 절대 Git에 올리지 않습니다.
    - `VITE_NICEPAY_CLIENT_ID`는 초기 배포 시 무조건 빈 문자열(`""`)이어야 합니다. (사고 방지)

### 2-3. 안전 배포 (Safe Deployment)
- **행동**: 코드를 서버에 올립니다. 단, 안전장치를 거칩니다.
- **디테일**:
  - `npm run firebase:deploy...` 명령어를 사용합니다. (직접 `firebase deploy` 금지)
  - 배포 스크립트가 뱉어내는 경고(계정 불일치 등)를 무시하지 않습니다.

### 2-4. 최종 인도 (Handover)
- **행동**: 열쇠(계정)를 넘겨줍니다.
- **디테일**:
  - 관리자 페이지 URL이 정상 접속되는지 '시크릿 탭'에서 확인합니다.
  - 점주가 처음 로그인했을 때 "어? 화면이 왜 비었어?"라고 당황하지 않게, "상점 설정 마법사가 뜨는 게 정상입니다"라고 미리 안내 멘트를 준비합니다.

---

## 🤖 3. AI (AI Agent / System)
**핵심 미션**: "사람의 실수를 막는 **가드레일(Guardrail)**이자, 표준을 지키는 **감시자(Auditor)**."

### 3-1. 표준 프로세스 강제
- **행동**: 사용자가 SOP(표준절차)를 벗어난 행동을 하려 하면 경고합니다.
- **디테일**:
  - 예: "새 기능을 추가해줘" -> "템플릿 원본을 수정해야 합니다. 상점 리포지토리 직접 수정은 금지입니다." 라고 안내.

### 3-2. 안전장치 코드 관리
- **행동**: `check-deploy.mjs` 같은 스크립트를 유지보수합니다.
- **디테일**:
  - Firebase CLI 버전이 바뀌거나, 인증 방식이 바뀌면 스크립트도 그에 맞춰 업데이트합니다.

### 3-3. 문서 현행화 (Documentation Sync)
- **행동**: 코드가 바뀌면 문서도 바꿉니다.
- **디테일**:
  - 기능이 변경되었는데 `SOP` 문서는 그대로라면, 그 문서는 쓰레기가 됩니다. AI는 이를 실시간으로 동기화합니다.
